package com.gamesense.client.module.modules.exploits;

import com.gamesense.client.module.Category;
import com.gamesense.client.module.Module;
import net.minecraft.init.Items;
import net.minecraft.item.ItemBlock;
import net.minecraft.item.ItemFood;
import net.minecraft.network.play.client.CPacketPlayerTryUseItemOnBlock;
import net.minecraft.util.EnumHand;
import net.minecraft.util.math.RayTraceResult;

/*
 * @author hausemasterissue
 * @since 1/10/2021
 * "borrowed" from osiris+
 */

@Module.Declaration(name = "MultiTask", category = Category.Exploits)
public class MultiTask extends Module {
	
	 @Override
	    public void onUpdate() {
	        if (mc.gameSettings.keyBindUseItem.isKeyDown() && mc.player.getActiveHand() == EnumHand.MAIN_HAND) {
	            if (mc.player.getHeldItemOffhand().getItem() instanceof ItemBlock || mc.player.getHeldItemOffhand().getItem() == Items.END_CRYSTAL) {
	                final RayTraceResult r = mc.player.rayTrace(6.0, mc.getRenderPartialTicks());
					assert r != null;
					mc.player.connection.sendPacket(new CPacketPlayerTryUseItemOnBlock(r.getBlockPos(), r.sideHit, EnumHand.OFF_HAND, 0.0f, 0.0f, 0.0f));
	            } else if (mc.player.getHeldItemOffhand().getItem() instanceof ItemFood && mc.gameSettings.keyBindUseItem.isKeyDown() && mc.gameSettings.keyBindAttack.isKeyDown()) {
	                mc.player.setActiveHand(EnumHand.OFF_HAND);
	                final RayTraceResult r = mc.player.rayTrace(6.0, mc.getRenderPartialTicks());
	                mc.player.swingArm(EnumHand.MAIN_HAND);
	            }
	        }
	    }

}
